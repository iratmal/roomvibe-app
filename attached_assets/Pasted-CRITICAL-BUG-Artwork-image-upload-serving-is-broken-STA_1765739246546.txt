CRITICAL BUG â€” Artwork image upload & serving is broken (STAGING)

Observed behavior:

Existing artworks load metadata correctly

Image requests fail:

GET /api/artwork-image/:id â†’ 404
Console: Image failed to load


Editing artwork metadata works

Uploading/replacing artwork image fails â†’ â€œFail to update artworkâ€

Root cause (confirmed):
Artwork image storage and image serving are not aligned.
The backend cannot find the image file for an existing artwork.

ğŸ¯ Expected behavior

Artwork image upload succeeds

Artwork record stores correct image reference

/api/artwork-image/:id reliably returns the image

Editing artwork with or without changing image works

âœ… REQUIRED FIX (NO UI CHANGES)
1ï¸âƒ£ Audit image upload flow

Identify where artwork images are stored:

local filesystem path OR

cloud storage (S3 / equivalent)

Verify upload middleware:

correct field name (image, file, artworkImage)

correct destination path

write permissions in staging

2ï¸âƒ£ Audit DB image reference

For an artwork record, confirm:

which field stores image reference (imagePath, imageKey, imageUrl)

that the stored value matches the actual file location

Example (must be consistent):

DB: imagePath = uploads/artworks/10.png
Server: serves from /uploads/artworks/10.png
API: /api/artwork-image/10 â†’ resolves to that file

3ï¸âƒ£ Fix /api/artwork-image/:id

Must:

fetch artwork by ID

resolve image path safely

return image with correct headers

Must return:

200 with image

404 ONLY if image truly does not exist

No silent failures

4ï¸âƒ£ Fix edit + upload behavior

Editing artwork without changing image must NOT fail

Editing artwork with new image must:

upload new file

replace old reference

delete old file if applicable (optional but recommended)

5ï¸âƒ£ Improve error handling (MANDATORY)

Replace generic â€œFail to update artworkâ€ with:

â€œImage upload failed: <reason>â€

or â€œArtwork updated, but image missingâ€

Return proper status codes:

upload error â†’ 400 / 413

missing file â†’ 404

server error â†’ 500

ğŸ›‘ STOP CONDITIONS

/api/artwork-image/:id returns 200 for existing artworks

Existing artworks display images correctly

Editing artwork metadata works

Uploading/replacing artwork image works

No regression in artwork creation

ğŸ“¦ DELIVERABLE

Agent must report:

Where images are stored

Which DB field references them

What was broken

What was changed

Confirmation with screenshot or log